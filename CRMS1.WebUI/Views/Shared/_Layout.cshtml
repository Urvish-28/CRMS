<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - CRMS </title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @*  <script src="~/Scripts/kendo/2017.2.621/jquery.min.js"></script>*@
    <script src="~/Scripts/jquery-3.4.1.min.js"></script>

    <script src="~/Scripts/kendo/2017.2.621/kendo.all.min.js"></script>
    <script src="~/Scripts/kendo/2017.2.621/kendo.aspnetmvc.min.js"></script>
    <link href="~/Content/css/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>

    <div class="header">
        <div class="container">
            <div class="align-center align-between">
                <div class="align-center">
                    <div class="logoDiv"> <a href="#"> <img src="~/Content/image/logo.svg" alt="CRB Logo"> </a> 
                    </div>
                    <div class="menuDiv">
                        <ul class="align-center myDiv" id="List">
                        </ul>
                    </div>
                </div>
                <div class="userInfo">
                    <div class="align-center">
                        <div class="userProfile">
                        </div>
                        <div class="userName align-center">
                            <span>Hello @Session["Name"] </span>
                            <i> <img src="~/Content/image/down-arrow.svg" alt="Dropdown Icon"> </i>
                            <div class="userInfoDiv">
                                <div class="userInfoBox">
                                    <a href="#">Profile</a>
                                    @*<a href="#">Settings</a>*@
                                    <a href="@Url.Action("ChangePassword","User")">Change Password</a>
                                    <a href="@Url.Action("Logout" , "Account")">logout</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container body-content">
        <br />
        @RenderBody()
        <hr />
        <footer>
            <p>&copy; @DateTime.Now.Year - CRB </p>
        </footer>
    </div>

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/kendoJs")
    @Styles.Render("~/bundles/kendoCss")
    <script src='@Url.Content("~/Scripts/jquery.validate.js")' type='text/javascript'></script>
    <script src='@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")' type='text/javascript'></script>
    @RenderSection("scripts", required: false)
</body>
</html>

<style>
    .dropdown .dropdown-menu {
        display: none;
        position: absolute;
        background-color: #f8f8f8;
        padding: 10px;
    }

    .dropdown:hover .dropdown-menu {
        display: block;
        color: white;
        font-size: 16px;
        text-align: justify;
        padding: 10px 10px;
        text-decoration: none;
    }

    .dropdown .dropdown-menu:after {
        height: 16px;
        width: 16px;
        background: #ffffff;
        position: absolute;
        content: "";
        top: -7px;
        right: 3px;
        transform: rotate(45deg);
        border-radius: 3px;
    }
</style>

<script>
@*    function Hover() {
        $(".dropdown").hover(
            function () {
                $(this).find(".dropdown-menu").stop(true, true).fadeIn("fast");
            },
            function () {
                $(this).find(".dropdown-menu").stop(true, true).fadeOut("fast");
            }
        );
    }*@


    $(document).ready(function () {
        $.ajax({
            url: '@Url.Action("FormList", "FormMst")',
            type: "GET",
            dataType: "json",
            success: function (data) {
                var result = data.filter(x => x.ParentFormId == null);
                $.each(result, function (index, item) {
                    var dropdown = data.filter(x => x.ParentFormId == item.Id);
                    if (dropdown.length == 0) {
                        $("<li><a href='" + item.NavigateURL + "'>" + item.Name + "</a></li>").appendTo("#List");
                    }
                    else {
                      //var li = $("<a class='popout' href='#'>" + item.Name + "</a>").appendTo(".dropdown");
                        var li = $('<li class="dropdown"><a onmouseover="Hover()" class="popout" href="#"> ' + item.Name + '<i><img style="padding: 0 4px 0 4px" src="/Content/image/down-arrow.svg"></i></a></li>)').appendTo("#List");
                        var ul = $("<ul class='level2 dropdown-menu userInfoDiv'></ul>").appendTo(li);
                        var result = data.filter(x => x.ParentFormId == item.Id);
                        $.each(result, function (i, child) {
                            $("<li><a href='" + child.NavigateURL + "'>" + child.Name + "</a></li>").appendTo(ul);
                        });
                    }
                });
            },
            error: function (xhr, status, error) {
                console.log(error);
            }
        });
    });
</script>
